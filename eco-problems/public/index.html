<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω–∞</title>
  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    /* –°—Ç–∏–ª—å –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –∫–∞—Ä—Ç–æ–π */
    #mapModal {
      display: none;
      position: fixed;
      z-index: 9999;
      left: 0;
      top: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.8);
    }
    #mapContainer {
      position: relative;
      width: 90%;
      height: 80vh;
      margin: 5vh auto;
      background: #fff;
      border-radius: 10px;
      overflow: hidden;
    }
    #map {
      height: 100%;
      width: 100%;
    }
    .close-map {
      position: absolute;
      top: 10px;
      right: 15px;
      background: #f44336;
      color: white;
      border: none;
      font-size: 20px;
      padding: 5px 10px;
      cursor: pointer;
      border-radius: 6px;
      z-index: 1000;
    }
    .show-map-btn {
      padding: 10px 20px;
      font-size: 18px;
      background-color: #4caf50;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: background 0.3s ease;
    }
    .show-map-btn:hover {
      background-color: #388e3c;
    }

    /* –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ö–æ–¥ - –∫–Ω–æ–ø–∫–∏ */
    header .auth-buttons {
      margin-top: 10px;
      text-align: right;
    }
    header .auth-buttons button {
      background: #4caf50;
      border: none;
      color: white;
      padding: 8px 14px;
      margin-left: 10px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.3s;
    }
    header .auth-buttons button:hover {
      background: #388e3c;
    }

    /* –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –≤—Ö–æ–¥–∞ */
    .modal {
      position: fixed;
      z-index: 10000;
      left: 0; top: 0;
      width: 100%; height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: none;
      justify-content: center;
      align-items: center;
    }
    .modal-content {
      background: white;
      border-radius: 8px;
      padding: 25px 30px;
      width: 320px;
      position: relative;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
      font-family: 'Roboto', sans-serif;
    }
    .modal-content h2 {
      margin-top: 0;
      color: #4caf50;
      font-weight: 700;
    }
    .modal-content input {
      width: 100%;
      padding: 10px 12px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 14px;
    }
    .modal-content button {
      width: 100%;
      background: #4caf50;
      border: none;
      color: white;
      font-weight: 700;
      padding: 12px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s;
      font-size: 16px;
    }
    .modal-content button:hover {
      background: #388e3c;
    }
    .close {
      position: absolute;
      right: 15px;
      top: 10px;
      font-size: 24px;
      cursor: pointer;
      color: #555;
    }
    .error {
      color: red;
      font-size: 13px;
      margin-top: -12px;
      margin-bottom: 10px;
      min-height: 18px;
      font-weight: 600;
    }
  </style>
</head>
<body>
  <section style="text-align: center; margin: 40px 0;">
    <button class="show-map-btn" onclick="openMap()">–ü–æ–∫–∞–∑–∞—Ç—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—É—é –∫–∞—Ä—Ç—É</button>
  </section>
  <header>
    <div class="container">
      <h1>–≠–∫–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω–∞</h1>
      <nav>
        <ul>
          <li><a href="#">–ì–ª–∞–≤–Ω–∞—è</a></li>
          <li><a href="#problems">–ü—Ä–æ–±–ª–µ–º—ã</a></li>
          <li><a href="#add-problem">–î–æ–±–∞–≤–∏—Ç—å</a></li>
        </ul>
      </nav>
      <div class="auth-buttons">
        <button id="openRegisterBtn">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
        <button id="openLoginBtn">–í—Ö–æ–¥</button>
      </div>
    </div>
  </header>

  <section class="hero">
    <div class="container">
      <h2>–ó–∞—â–∏—Ç–∏–º –ø—Ä–∏—Ä–æ–¥—É –ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω–∞ –≤–º–µ—Å—Ç–µ!</h2>
      <p>–ü—Ä–æ–±–ª–µ–º—ã –æ–∫—Ä—É–∂–∞—é—â–µ–π —Å—Ä–µ–¥—ã —Ç—Ä–µ–±—É—é—Ç –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è. –û–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å —Ç–µ–∫—É—â–∏–º–∏ –≤—ã–∑–æ–≤–∞–º–∏ –∏ –≤–Ω–µ—Å–∏—Ç–µ —Å–≤–æ–π –≤–∫–ª–∞–¥.</p>
      <img src="images/kyrgyzstan.jpg.jfif" alt="–ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω –ø—Ä–∏—Ä–æ–¥–∞" />
    </div>
  </section>

  <section id="problems" class="container">
  <h2>–°–ø–∏—Å–æ–∫ –ø—Ä–æ–±–ª–µ–º</h2>
  
  <select id="categoryFilter">
    <option value="all">–í—Å–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏</option>
    <option value="–í–æ–∑–¥—É—Ö">–í–æ–∑–¥—É—Ö</option>
    <option value="–õ–µ—Å–∞">–õ–µ—Å–∞</option>
    <option value="–û—Ç—Ö–æ–¥—ã">–û—Ç—Ö–æ–¥—ã</option>
    <option value="–í–æ–¥–∞">–í–æ–¥–∞</option>
    <option value="–ó–µ–º–ª—è">–ó–µ–º–ª—è</option>
    <option value="–§–ª–æ—Ä–∞ –∏ —Ñ–∞—É–Ω–∞">–§–ª–æ—Ä–∞ –∏ —Ñ–∞—É–Ω–∞</option>
  </select>
  
  <input type="text" id="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é..." />
  <div id="problemsList" class="card-list"></div>
</section>


  <section id="add-problem" class="container">
    <h2>–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É</h2>
    <form id="problemForm">
      <input type="text" id="title" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ" required />
      <textarea id="description" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ" required></textarea>
      <input type="text" id="location" placeholder="–õ–æ–∫–∞—Ü–∏—è (–≥–æ—Ä–æ–¥/—Ä–µ–≥–∏–æ–Ω)" required />
      <button type="submit">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </form>
  </section>

  <footer>
    <div class="container">
      <p>¬© 2025 –≠–∫–æ–ª–æ–≥–∏—è –ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω–∞. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
    </div>
  </footer>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∫–∞—Ä—Ç—ã -->
  <div id="mapModal">
    <div id="mapContainer">
      <button class="close-map" onclick="closeMap()">‚úñ</button>
      <div id="map"></div>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
  <div id="registerModal" class="modal">
    <div class="modal-content">
      <span class="close" id="closeRegister">&times;</span>
      <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
      <form id="registerForm">
        <input type="text" name="username" placeholder="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" required />
        <input type="email" name="email" placeholder="Email" required />
        <input type="password" name="password" placeholder="–ü–∞—Ä–æ–ª—å (–º–∏–Ω. 6 —Å–∏–º–≤–æ–ª–æ–≤)" required minlength="6" />
        <button type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
        <div id="registerError" class="error"></div>
      </form>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª–∫–∞ –í—Ö–æ–¥–∞ -->
  <div id="loginModal" class="modal">
    <div class="modal-content">
      <span class="close" id="closeLogin">&times;</span>
      <h2>–í—Ö–æ–¥</h2>
      <form id="loginForm">
        <input type="email" name="email" placeholder="Email" required />
        <input type="password" name="password" placeholder="–ü–∞—Ä–æ–ª—å" required />
        <button type="submit">–í–æ–π—Ç–∏</button>
        <div id="loginError" class="error"></div>
      </form>
    </div>
  </div>

  <script>
    // –ö–∞—Ä—Ç–∞ –∏ —Ä–µ–≥–∏–æ–Ω—ã (—Ç–≤–æ–π —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥)
    const regions = [
      {
        name: "–ë–∏—à–∫–µ–∫",
        lat: 42.8746,
        lng: 74.5698,
        problems: "–ó–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –≤–æ–∑–¥—É—Ö–∞, —Å—Ç–∏—Ö–∏–π–Ω—ã–µ —Å–≤–∞–ª–∫–∏"
      },
      {
        name: "–ß—É–π—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
        lat: 42.8355,
        lng: 75.2995,
        problems: "–ó–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –ø–æ—á–≤—ã, –º—É—Å–æ—Ä"
      },
      {
        name: "–û—à—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
        lat: 40.5134,
        lng: 72.8161,
        problems: "–í—ã—Ä—É–±–∫–∞ –ª–µ—Å–æ–≤, –æ—Ç—Ö–æ–¥—ã"
      },
      {
        name: "–î–∂–∞–ª–∞–ª-–ê–±–∞–¥—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
        lat: 40.9333,
        lng: 73.0,
        problems: "–ó–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ —Ä–µ–∫, —Å–≤–∞–ª–∫–∏"
      },
      {
        name: "–ë–∞—Ç–∫–µ–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
        lat: 39.9376,
        lng: 70.8295,
        problems: "–ü—Ä–æ–±–ª–µ–º—ã —Å –≤–æ–¥–æ–π, –±—Ä–∞–∫–æ–Ω—å–µ—Ä—Å—Ç–≤–æ"
      },
      {
        name: "–ò—Å—Å—ã–∫-–ö—É–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
        lat: 42.1856,
        lng: 77.5615,
        problems: "–ó–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –æ–∑–µ—Ä–∞, –±–µ—Ä–µ–≥–æ–≤–∞—è –ª–∏–Ω–∏—è"
      },
      {
        name: "–ù–∞—Ä—ã–Ω—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
        lat: 41.4275,
        lng: 75.9911,
        problems: "–ó–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –ø–∞—Å—Ç–±–∏—â, –æ—Ç—Ö–æ–¥—ã —Å–∫–æ—Ç–∞"
      },
      {
        name: "–¢–∞–ª–∞—Å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å",
        lat: 42.5228,
        lng: 72.2426,
        problems: "–°–µ–ª—å—Ö–æ–∑–æ—Ç—Ö–æ–¥—ã, –Ω–µ—Ö–≤–∞—Ç–∫–∞ —É—Ç–∏–ª–∏–∑–∞—Ü–∏–∏"
      }
    ];

    let map = null; // –≥–ª–æ–±–∞–ª—å–Ω–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è

    function openMap() {
      document.getElementById("mapModal").style.display = "block";

      setTimeout(() => {
        // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –∫–∞—Ä—Ç—É, –µ—Å–ª–∏ –æ–Ω–∞ –±—ã–ª–∞
        if (map) {
          map.remove();
          map = null;
        }

        // –û—á–∏—â–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
        document.getElementById("map").innerHTML = "";

        // –°–æ–∑–¥–∞—ë–º –Ω–æ–≤—É—é –∫–∞—Ä—Ç—É
        map = L.map("map").setView([41.5, 75], 6.5);

        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
          attribution: '&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors'
        }).addTo(map);

        // –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Ä–∫–µ—Ä—ã
        regions.forEach((region) => {
          L.marker([region.lat, region.lng])
            .addTo(map)
            .bindPopup(`
              <div class="map-popup">
                <strong>${region.name}</strong><br>
                ${region.problems
                  .split(", ")
                  .map(p => `üåø ${p}`)
                  .join("<br>")}
              </div>
            `);
        });
      }, 300); // –ñ–¥—ë–º, –ø–æ–∫–∞ –º–æ–¥–∞–ª–∫–∞ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—Å—è
    }

    function closeMap() {
      document.getElementById("mapModal").style.display = "none";
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª–æ–∫ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∏ –í—Ö–æ–¥–∞
    const registerModal = document.getElementById('registerModal');
    const loginModal = document.getElementById('loginModal');
    document.getElementById('openRegisterBtn').onclick = () => {
      registerModal.style.display = 'flex';
      loginModal.style.display = 'none';
    };
    document.getElementById('openLoginBtn').onclick = () => {
      loginModal.style.display = 'flex';
      registerModal.style.display = 'none';
    };
    document.getElementById('closeRegister').onclick = () => {
      registerModal.style.display = 'none';
    };
    document.getElementById('closeLogin').onclick = () => {
      loginModal.style.display = 'none';
    };
    window.onclick = (event) => {
      if(event.target === registerModal) registerModal.style.display = 'none';
      if(event.target === loginModal) loginModal.style.display = 'none';
      if(event.target === document.getElementById('mapModal')) closeMap();
    };

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ /api/register)
    document.getElementById('registerForm').onsubmit = async (e) => {
      e.preventDefault();
      const form = e.target;
      const username = form.username.value.trim();
      const email = form.email.value.trim();
      const password = form.password.value;

      const errorDiv = document.getElementById('registerError');
      errorDiv.textContent = '';

      if (password.length < 6) {
        errorDiv.textContent = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤.';
        return;
      }

      try {
        const response = await fetch('/api/auth/register', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ username, email, password })
        });
        if (!response.ok) {
          const result = await response.json();
          errorDiv.textContent = result.message || '–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏';
        } else {
          alert('–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ! –¢–µ–ø–µ—Ä—å –≤–æ–π–¥–∏—Ç–µ.');
          form.reset();
          registerModal.style.display = 'none';
          loginModal.style.display = 'flex';
        }
      } catch (err) {
        errorDiv.textContent = '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞.';
      }
    };

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥–∞ (–ø—Ä–∏–º–µ—Ä, –æ—Ç–ø—Ä–∞–≤–∫–∞ –Ω–∞ /api/login)
    document.getElementById('loginForm').onsubmit = async (e) => {
      e.preventDefault();
      const form = e.target;
      const email = form.email.value.trim();
      const password = form.password.value;

      const errorDiv = document.getElementById('loginError');
      errorDiv.textContent = '';

      try {
        const response = await fetch('/api/auth/login', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ email, password })
        });
        if (!response.ok) {
          const result = await response.json();
          errorDiv.textContent = result.message || '–ù–µ–≤–µ—Ä–Ω—ã–π email –∏–ª–∏ –ø–∞—Ä–æ–ª—å.';
        } else {
          alert('–í—Ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!');
          form.reset();
          loginModal.style.display = 'none';
          // –¢—É—Ç –º–æ–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å UI –¥–ª—è –≤–æ—à–µ–¥—à–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        }
      } catch (err) {
        errorDiv.textContent = '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏ –∏–ª–∏ —Å–µ—Ä–≤–µ—Ä–∞.';
      }
    };

    // –õ–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º (–ø—Ä–∏–º–µ—Ä)
    const problemsList = document.getElementById('problemsList');
    const searchInput = document.getElementById('search');

    // –ú–∞—Å—Å–∏–≤ –ø—Ä–æ–±–ª–µ–º ‚Äî —Ç—É—Ç –º–æ–∂–Ω–æ –ø–æ–¥–∫–ª—é—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö
    let problems = [
  { 
    title: '–ó–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –≤–æ–∑–¥—É—Ö–∞ –≤ –ë–∏—à–∫–µ–∫–µ', 
    description: '–í—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –≤—ã–±—Ä–æ—Å–æ–≤ –≤ –∞—Ç–º–æ—Å—Ñ–µ—Ä—É –æ—Ç —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞ –∏ –ø—Ä–µ–¥–ø—Ä–∏—è—Ç–∏–π.',
    category: '–í–æ–∑–¥—É—Ö'
  },
  { 
    title: '–í—ã—Ä—É–±–∫–∞ –ª–µ—Å–æ–≤ –≤ –û—à—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏', 
    description: '–ù–µ–∑–∞–∫–æ–Ω–Ω—ã–µ –≤—ã—Ä—É–±–∫–∏ –∏ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏—è –ª–µ—Å–Ω—ã—Ö –º–∞—Å—Å–∏–≤–æ–≤.',
    category: '–õ–µ—Å–∞'
  },
  { 
    title: '–°–≤–∞–ª–∫–∏ –æ—Ç—Ö–æ–¥–æ–≤ –≤ –ß—É–π—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏', 
    description: '–ù–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–≤–∞–ª–∫–∏ –ø—Ä–∏–≤–æ–¥—è—Ç –∫ –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—é –ø–æ—á–≤—ã –∏ –≤–æ–¥—ã.',
    category: '–û—Ç—Ö–æ–¥—ã'
  },
  { 
    title: '–ó–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ –æ–∑–µ—Ä–∞ –ò—Å—Å—ã–∫-–ö—É–ª—å', 
    description: '–†–æ—Å—Ç —É—Ä–æ–≤–Ω—è –∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏—è –±–µ—Ä–µ–≥–æ–≤–æ–π –ª–∏–Ω–∏–∏ –∏ –≤–æ–¥–æ—ë–º–∞.',
    category: '–í–æ–¥–∞'
  },
  { 
    title: '–î–µ–≥—Ä–∞–¥–∞—Ü–∏—è –ø–∞—Å—Ç–±–∏—â –≤ –ù–∞—Ä—ã–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏', 
    description: '–ü–µ—Ä–µ–Ω–∞—Å–µ–ª–µ–Ω–∏–µ —Å–∫–æ—Ç–∞ –∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∑–µ–º–µ–ª—å.',
    category: '–ó–µ–º–ª—è'
  },
  { 
    title: '–ù–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ —É—Ç–∏–ª–∏–∑–∞—Ü–∏–∏ —Å–µ–ª—å—Ö–æ–∑–æ—Ç—Ö–æ–¥–æ–≤ –≤ –¢–∞–ª–∞—Å—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏', 
    description: '–ü—Ä–æ–±–ª–µ–º—ã —Å –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–æ–π –∏ —É—Ç–∏–ª–∏–∑–∞—Ü–∏–µ–π –æ—Ç—Ö–æ–¥–æ–≤ —Å –ø–æ–ª–µ–π.',
    category: '–û—Ç—Ö–æ–¥—ã'
  },
  { 
    title: '–ó–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ —Ä–µ–∫ –≤ –î–∂–∞–ª–∞–ª-–ê–±–∞–¥—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏', 
    description: '–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω—ã–µ –∏ –±—ã—Ç–æ–≤—ã–µ —Å—Ç–æ–∫–∏ —É—Ö—É–¥—à–∞—é—Ç –∫–∞—á–µ—Å—Ç–≤–æ –≤–æ–¥—ã.',
    category: '–í–æ–¥–∞'
  },
  { 
    title: '–ü—Ä–æ–±–ª–µ–º—ã —Å –≤–æ–¥–æ—Å–Ω–∞–±–∂–µ–Ω–∏–µ–º –≤ –ë–∞—Ç–∫–µ–Ω—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏', 
    description: '–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —á–∏—Å—Ç–æ–π –ø–∏—Ç—å–µ–≤–æ–π –≤–æ–¥–µ –¥–ª—è –Ω–∞—Å–µ–ª–µ–Ω–∏—è.',
    category: '–í–æ–¥–∞'
  },
  { 
    title: '–ë—Ä–∞–∫–æ–Ω—å–µ—Ä—Å—Ç–≤–æ –∏ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ —Ñ–ª–æ—Ä—ã –∏ —Ñ–∞—É–Ω—ã', 
    description: '–ù–µ–∑–∞–∫–æ–Ω–Ω—ã–π –æ—Ç–ª–æ–≤ –∏ –≤—ã—Ä—É–±–∫–∞ —É–≥—Ä–æ–∂–∞—é—Ç —ç–∫–æ—Å–∏—Å—Ç–µ–º–∞–º —Ä–µ–≥–∏–æ–Ω–∞.',
    category: '–§–ª–æ—Ä–∞ –∏ —Ñ–∞—É–Ω–∞'
  },
  { 
    title: '–ü—ã–ª—å–Ω—ã–µ –±—É—Ä–∏ –∏ —ç—Ä–æ–∑–∏—è –ø–æ—á–≤—ã', 
    description: '–í–æ–∑—Ä–∞—Å—Ç–∞—é—â–∏–µ –ø—Ä–∏—Ä–æ–¥–Ω—ã–µ —è–≤–ª–µ–Ω–∏—è, —É—Ö—É–¥—à–∞—é—â–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∑–µ–º–µ–ª—å.',
    category: '–ó–µ–º–ª—è'
  }
];


    function renderProblems(list) {
      problemsList.innerHTML = '';
      if(list.length === 0) {
        problemsList.innerHTML = '<p>–ü—Ä–æ–±–ª–µ–º—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.</p>';
        return;
      }
      list.forEach(item => {
        const card = document.createElement('div');
        card.classList.add('card');
        card.style.border = '1px solid #ccc';
        card.style.borderRadius = '8px';
        card.style.padding = '15px';
        card.style.marginBottom = '12px';
        card.innerHTML = `<h3>${item.title}</h3><p>${item.description}</p>`;
        problemsList.appendChild(card);
      });
    }

   const categoryFilter = document.getElementById('categoryFilter');

function filterProblems() {
  const query = searchInput.value.toLowerCase();
  const category = categoryFilter.value;

  let filtered = problems;

  if (category !== 'all') {
    filtered = filtered.filter(p => p.category === category);
  }

  if (query) {
    filtered = filtered.filter(p => p.title.toLowerCase().includes(query));
  }

  renderProblems(filtered);
}

searchInput.addEventListener('input', filterProblems);
categoryFilter.addEventListener('change', filterProblems);

// –ù–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä –ø—Ä–æ–±–ª–µ–º (–æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –µ—Å—Ç—å)
renderProblems(problems);

    // –ù–∞—á–∞–ª—å–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä –ø—Ä–æ–±–ª–µ–º
    renderProblems(problems);

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π –ø—Ä–æ–±–ª–µ–º—ã
    document.getElementById('problemForm').onsubmit = e => {
      e.preventDefault();
      const title = document.getElementById('title').value.trim();
      const description = document.getElementById('description').value.trim();
      const location = document.getElementById('location').value.trim();

      if (!title || !description || !location) {
        alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è.');
        return;
      }

      problems.push({ title: `${title} (${location})`, description });
      renderProblems(problems);
      e.target.reset();
      alert('–ü—Ä–æ–±–ª–µ–º–∞ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞!');
    };
  </script>

  <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Leaflet.js –ü–û–°–õ–ï –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π, —á—Ç–æ–±—ã L –±—ã–ª –¥–æ—Å—Ç—É–ø–µ–Ω -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

</body>
</html>
